(function(){var e,t;e=["angular","core/services/storage","core/services/pageUtils","core/services/timeUtils","background/module","background/services/track"],t=function(e){var notificationManager;return notificationManager=function($rootScope,storage,server,timeUtils,pageUtils,track,ROLES,SERVER){var e,t,n,i;return chrome.notifications?(n={},e=function(){return server.on("notification",function(e){return chrome.notifications.create("",e.option,function(t){return n[t]=e}),track.event("notification",e.type,"show")}),chrome.notifications.onClicked.addListener(function(e){var t;return(t=n[e])?(pageUtils.openUrl("options"===t.url?"options.html":t.url),track.event("notification",t.type,"click")):void 0}),chrome.notifications.onButtonClicked.addListener(function(e,t){var i,o;return(o=n[e])?(i=o.options.buttons[t].title,"Please Renew VIP"===o.type&&storage.set("disableNotifyRenewVIP",!0),track.event("notification",o.type,"button-click:"+i)):void 0}),server.on("profile",function(){return setTimeout(function(){var e,n,o;if((null!=(e=$rootScope.user)?e.role:void 0)===ROLES.USER){if(null!=(n=$rootScope.user)&&null!=(o=n.profile)?o.until:void 0){if(storage.get("disableNotifyRenewVIP"))return;return i()}return t()}})})},t=function(){var e,t,i;return e={options:{title:"请开通VIP服务",message:"红杏已关闭免费服务，请开通付费VIP服务。",contextMessage:"（低至1元，点击看价格）",type:"basic",iconUrl:"img/logo.png"},type:"Please Create VIP",url:"https://"+SERVER+"/pay/index?name="+(null!=(t=$rootScope.user)&&null!=(i=t.profile)?i.name:void 0)},chrome.notifications.create("notifyCreateVIP",e.options,function(t){return n[t]=e}),track.event("notification",e.type,"show")},i=function(){var e,t,i;return e={options:{title:"VIP已过期",message:"为了能够继续使用红杏的服务，请及时续费。",contextMessage:"（点击续费）",buttons:[{title:"不再提示"}],type:"basic",iconUrl:"img/logo.png"},type:"Please Renew VIP",url:"https://"+SERVER+"/pay/index?name="+(null!=(t=$rootScope.user)&&null!=(i=t.profile)?i.name:void 0)},chrome.notifications.create("notifyRenewVIP",e.options,function(t){return n[t]=e}),track.event("notification",e.type,"show")},e(),this):this},e.module("background").service("notificationManager",notificationManager)},define(e,t)}).call(this);